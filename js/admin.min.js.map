{"version":3,"sources":["admin.js"],"names":["nL","Framework","Language","LanguageSet","LocalizableField","LocalizableFieldSet","Languages","LocalizableFields","window","nLingual","Backbone","Model","extend","defaults","system_name","native_name","short_name","iso_code","slug","locale_name","direction","active","Collection","model","idAttribute","field_id","values","nonce","jQuery","$","change","name","this","data","concat","attr","checked","val","hide","each","text","click","$toggle","$section","parent","toggleClass","open","hasClass","find","animate","height","on","format","language","get","qvar","skip","override","replace","trigger","filter","show","method","$manager","$preset","$list","$addBtn","languageRowTemplate","languageRowIndex","preset","sortable","items","containment","handle","presets","append","buildLangRow","row","id","prop","attributes","regex","RegExp","$row","set","parents","first","not","$locale_name","$iso_code","$slug","substr","toLowerCase","$localizerTemplate","html","nlingualL10n","LocalizeThis","title","LocalizeFor","field","hasLocalized","$field","length","is","$wrap","addClass","wrap","$control","clone","default_language","$unlocalized","appendTo","localized","$localized","$option","siblings","removeClass","value","tinymce","_typeof","e","editor","getElement","getContainer","after","content","wp","removep","getContent","autop","setContent","oldEditorSave","Editor","prototype","save","apply","arguments","fire","$parent","$input","$select","post_id","post_language_id","translation_language_id","admin_post","param","action","onload","_slicedToArray","location","href","match","target","parseInt","alert","NoPostSelected","url","confirm","RemoveTranslationConfirm","$title","language_id","ajax","ajaxurl","type","success","NoTranslation","error","RemoveTranslationError","inlineEditPost","wpInlineEditPost_edit","edit","post","getId","$postRow","$editRow","post_language","translation","inlineEditTax","wpInlineEditTax_edit"],"mappings":"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","sourcesContent":["/* globals jQuery, alert, confirm, wp, Backbone, tinymce, ajaxurl, inlineEditPost, inlineEditTax, nlingualL10n */\n( () => {\n\tvar nL = window.nLingual = {};\n\n\t// =========================\n\t// ! Backbone Stuff\n\t// =========================\n\n\tvar Framework = nL.Framework = {};\n\n\t// Language model\n\tvar Language = Framework.Language = Backbone.Model.extend( {\n\t\tdefaults: {\n\t\t\tsystem_name : '',\n\t\t\tnative_name : '',\n\t\t\tshort_name  : '',\n\t\t\tiso_code    : '',\n\t\t\tslug        : '',\n\t\t\tlocale_name : '',\n\t\t\tdirection   : '',\n\t\t\tactive      : true,\n\t\t},\n\t} );\n\n\t// Languages collection\n\tvar LanguageSet = Framework.LanguageSet = Backbone.Collection.extend( {\n\t\tmodel: Language,\n\t} );\n\n\t// LocalizableField model\n\tvar LocalizableField = Framework.LocalizableField = Backbone.Model.extend( {\n\t\tidAttribute : 'field',\n\t\tdefaults    : {\n\t\t\tfield_id : '',\n\t\t\tvalues   : '',\n\t\t\tnonce    : '',\n\t\t},\n\t} );\n\n\t// LocalizableFieldSet collection\n\tvar LocalizableFieldSet = Framework.LocalizableFieldSet = Backbone.Collection.extend( {\n\t\tmodel: LocalizableField,\n\t} );\n\n\t// =========================\n\t// ! Setup Main Collections\n\t// =========================\n\n\tvar Languages = nL.Languages = new LanguageSet();\n\tvar LocalizableFields = nL.LocalizableFields = new LocalizableFieldSet();\n\n\t// =========================\n\t// ! jQuery Stuff\n\t// =========================\n\n\tjQuery( $ => {\n\t\t// =========================\n\t\t// ! Setings Pages\n\t\t// =========================\n\n\t\t// Check all fields of a matching name\n\t\t$( '.nl-checkall' ).change( function() {\n\t\t\tvar name = $( this ).data( 'name' );\n\t\t\t$( `input[name=\"${name}[]\"]` ).attr( 'checked', this.checked );\n\t\t} );\n\t\t$( '.nl-matchall' ).change( function() {\n\t\t\tvar name = $( this ).data( 'name' );\n\t\t\t$( `[name=\"${name}\"]` ).val( this.checked ? '*' : '' );\n\t\t} );\n\n\t\t// Hide all sections by default\n\t\t$( '.nl-section-content' ).hide();\n\n\t\t// Add toggle feature for sections\n\t\t$( '.nl-section-toggle' ).each( function() {\n\t\t\t$( this ).data( 'text', $( this ).text() );\n\t\t} ).click( function() {\n\t\t\tvar $toggle  = $( this );\n\t\t\tvar $section = $toggle.parent();\n\n\t\t\t$section.toggleClass( 'open' );\n\t\t\tvar open = $section.hasClass( 'open' );\n\n\t\t\t$section.find( '.nl-section-content' ).animate( { height: 'toggle' } );\n\n\t\t\t$toggle.text( $toggle.data( open ? 'alt' : 'text' ) );\n\t\t} );\n\n\t\t// Handle rendering of the previews\n\t\t$( '.nl-preview' ).on( 'nl:render', function() {\n\t\t\t// Get the default language slug, defaulting to \"en\"\n\t\t\tvar language = Languages.get( $( '#nlingual_default_language' ).val() );\n\n\t\t\tvar slug = language && language.get( 'slug' ) || 'en';\n\n\t\t\t// Get the query var, defaulting to \"nl_language\"\n\t\t\tvar qvar = $( '#nlingual_query_var' ).val() || 'nl_language';\n\n\t\t\t// Get the skip and override options\n\t\t\tvar skip = $( '#nlingual_skip_default_l10n' ).attr( 'checked' );\n\t\t\tvar override = $( '#nlingual_post_language_override' ).attr( 'checked' );\n\n\t\t\t// Get the format; some previews are dependent on options\n\t\t\tvar format;\n\t\t\tif ( $( this ).hasClass( 'nl-url-preview' ) ) {\n\t\t\t\tformat = $( this ).data( skip ? 'excluded' : 'included' );\n\t\t\t} else if ( $( this ).hasClass( 'nl-override-preview' ) ) {\n\t\t\t\tformat = $( this ).data( override ? 'on' : 'off' );\n\t\t\t} else {\n\t\t\t\tformat = $( this ).data( 'format' );\n\t\t\t}\n\n\t\t\t// Update the preview\n\t\t\t$( this ).text(\n\t\t\t\tformat\n\t\t\t\t.replace( /%l/g, slug )\n\t\t\t\t.replace( /%v/g, qvar )\n\t\t\t);\n\t\t} ).trigger( 'nl:render' );\n\n\t\t// Changing any of these will trigger re-rendering of the previews\n\t\t$( '#nlingual_default_language' ).change( function() {\n\t\t\t$( '.nl-preview' ).trigger( 'nl:render' );\n\t\t} );\n\t\t$( '#nlingual_skip_default_l10n' ).change( function() {\n\t\t\t$( '.nl-preview' ).trigger( 'nl:render' );\n\t\t} );\n\t\t$( '#nlingual_post_language_override' ).change( function() {\n\t\t\t$( '.nl-preview' ).trigger( 'nl:render' );\n\t\t} );\n\t\t$( '#nlingual_query_var' ).on( 'keyup change', function() {\n\t\t\t$( '.nl-preview' ).trigger( 'nl:render' );\n\t\t} );\n\n\t\t// Default to GET version of previews\n\t\t$( '.nl-preview' ).hide().filter( '.nl-redirect-get' ).show();\n\n\t\t// Changing the method will change which previews are shown\n\t\t$( 'input[name=\"nlingual_options[url_rewrite_method]\"]' ).change( function() {\n\t\t\tvar method = $( this ).val();\n\n\t\t\t// Ignore if it's not checked or somehow has no value\n\t\t\tif ( ! this.checked || ! method ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Show the associated preview while hiding the others\n\t\t\t$( '.nl-preview' ).hide().filter( `.nl-redirect-${method}` ).show();\n\t\t} ).change();\n\n\t\t// =========================\n\t\t// ! Language Manager\n\t\t// =========================\n\n\t\t$( '#nlingual_languages' ).each( function() {\n\t\t\t// Elements\n\t\t\tvar $manager = $( this );\n\t\t\tvar $preset  = $( '#nl_language_preset' );\n\t\t\tvar $list    = $( '#nl_language_list' );\n\t\t\tvar $addBtn  = $( '#nl_language_add' );\n\n\t\t\tvar languageRowTemplate = $( '#nl_language_row' ).text();\n\t\t\tvar languageRowIndex = -1;\n\n\t\t\t// Setup sortability\n\t\t\t$list.sortable( {\n\t\t\t\titems       : 'tr',\n\t\t\t\tcontainment : 'parent',\n\t\t\t\thandle      : '.handle',\n\t\t\t} );\n\n\t\t\t// Load preset selector\n\t\t\tfor ( const preset in nL.presets ) {\n\t\t\t\t$preset.append( `<option value=\"${preset}\">${nL.presets[ preset ].system_name}</option>` );\n\t\t\t}\n\n\t\t\t// Row builder utility\n\t\t\tfunction buildLangRow( language ) {\n\t\t\t\tvar row = languageRowTemplate.replace( /%id%/g, language.id );\n\n\t\t\t\t// Loop through properties and replace\n\t\t\t\tfor ( const prop in language.attributes ) {\n\t\t\t\t\tconst regex = new RegExp( '%' + prop + '%', 'g' );\n\t\t\t\t\trow = row.replace( regex, language.get( prop ) );\n\t\t\t\t}\n\n\t\t\t\t// Parse the row into a new element\n\t\t\t\tvar $row = $( row );\n\n\t\t\t\t// Check correct direction checkbox\n\t\t\t\t$row.find( `.nl-language-direction input[value=\"${language.get( 'direction' )}\"]` ).attr( 'checked', true );\n\n\t\t\t\t// Check active checkbox if true\n\t\t\t\t$row.find( '.nl-language-active input' ).attr( 'checked', language.get( 'active' ) );\n\n\t\t\t\t// Add the row to the table\n\t\t\t\t$list.append( $row ).sortable( 'refresh' );\n\t\t\t}\n\n\t\t\t// Load table with current languages\n\t\t\tLanguages.each( buildLangRow );\n\n\t\t\t// Add button functionality\n\t\t\t$addBtn.click( function() {\n\t\t\t\tvar language;\n\n\t\t\t\t// Check if preset was selected,\n\t\t\t\t// otherwise make blank language\n\t\t\t\tif ( $preset.val() ) {\n\t\t\t\t\tconst preset = $preset.val();\n\t\t\t\t\tlanguage = new Language( nL.presets[ preset ] );\n\t\t\t\t\tlanguage.set( 'iso_code', preset );\n\n\t\t\t\t\t// Reset preset selector\n\t\t\t\t\t$preset.val( null );\n\t\t\t\t} else {\n\t\t\t\t\tlanguage = new Language();\n\t\t\t\t}\n\n\t\t\t\t// Default values\n\t\t\t\tlanguage.id = languageRowIndex;\n\t\t\t\tlanguage.set( 'slug', language.get( 'iso_code' ) );\n\t\t\t\tlanguage.set( 'active', true );\n\n\t\t\t\tbuildLangRow( language );\n\n\t\t\t\tlanguageRowIndex--;\n\t\t\t} );\n\n\t\t\t// Delete button functionality\n\t\t\t$manager.on( 'change', '.nl-language-delete input', function() {\n\t\t\t\tvar $row = $( this ).parents( 'tr' ).first(); // Get the parent row\n\n\t\t\t\t// Toggle delete class and inputs\n\t\t\t\t$row.toggleClass( 'todelete', this.checked );\n\t\t\t\t$row.find( 'input' ).not( this ).attr( 'disabled', this.checked );\n\t\t\t} );\n\n\t\t\t// Auto-fill locale_name, iso_code and slug\n\t\t\t$manager.on( 'change', '.nl-language-system_name input', function() {\n\t\t\t\tvar $row = $( this ).parents( 'tr' ).first(); // Get the parent row\n\n\t\t\t\t// Get the text\n\t\t\t\tvar system_name = $( this ).val();\n\n\t\t\t\t// Get the other fields\n\t\t\t\tvar $locale_name = $row.find( '.nl-language-locale_name input' );\n\t\t\t\tvar $iso_code    = $row.find( '.nl-language-iso_code input' );\n\t\t\t\tvar $slug        = $row.find( '.nl-language-slug input' );\n\n\t\t\t\t// No ISO? Assume first 2 characters of system name\n\t\t\t\tif ( ! $iso_code.val() ) {\n\t\t\t\t\t$iso_code.val( system_name.substr( 0, 2 ).toLowerCase() );\n\t\t\t\t}\n\n\t\t\t\t// No locale? Assume same as ISO code\n\t\t\t\tif ( ! $locale_name.val() ) {\n\t\t\t\t\t$locale_name.val( $iso_code.val() );\n\t\t\t\t}\n\n\t\t\t\t// No slug? Assume same as ISO code\n\t\t\t\tif ( ! $slug.val() ) {\n\t\t\t\t\t$slug.val( $iso_code.val() );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\n\t\t// =========================\n\t\t// ! Input Localizer\n\t\t// =========================\n\n\t\t// Setup the base localizer\n\t\tvar $localizerTemplate = $( '<div class=\"nl-localizer\"></div>' ).html( function() {\n\t\t\tvar html = `<div class=\"nl-localizer-toggle\" title=\"${nlingualL10n.LocalizeThis}\"></div>`;\n\n\t\t\tLanguages.each( language => {\n\t\t\t\tvar title = nlingualL10n.LocalizeFor.replace( '%s', language.get( 'system_name' ) );\n\t\t\t\thtml += `<div class=\"nl-localizer-option\" title=\"${title}\" data-nl_language=\"${language.id}\">\n\t\t\t\t\t<div class=\"nl-option-text\" data-slug=\"${language.get( 'slug' )}\">${language.get( 'system_name' )}</div>\n\t\t\t\t</div>`;\n\t\t\t} );\n\n\t\t\treturn html;\n\t\t} );\n\n\t\tLocalizableFields.each( field => {\n\t\t\tvar field_id = field.get( 'field_id' );\n\t\t\tvar values   = field.get( 'values' );\n\t\t\tvar nonce    = field.get( 'nonce' );\n\n\t\t\tvar hasLocalized = false;\n\n\t\t\t// Get the field if it exists and is an input/textarea\n\t\t\tvar $field = $( '#' + field_id );\n\t\t\tif ( $field.length === 0 || ! $field.is( 'input, textarea' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$field.addClass( 'nl-localizable-input' );\n\n\t\t\t// Check if it's a tinymce editor field\n\t\t\tvar $wrap;\n\t\t\tif ( $field.hasClass( 'wp-editor-area' ) ) {\n\t\t\t\t// Use the editor wrapper as the container\n\t\t\t\t$wrap = $field.parents( '.wp-editor-wrap' );\n\t\t\t} else {\n\t\t\t\t// Wrap the field in a container\n\t\t\t\t$field.wrap( '<div class=\"nl-localizable\"></div>' );\n\t\t\t\t$wrap = $field.parent();\n\t\t\t}\n\n\t\t\t// Create the control\n\t\t\tvar $control = $localizerTemplate.clone();\n\n\t\t\t// Store the control reference in the field\n\t\t\t$field.data( '$nl_localizer', $control );\n\n\t\t\t// Store the current language of the control\n\t\t\t$control.data( 'nl_current_language', nL.default_language );\n\n\t\t\t// Store the field and wrapper reference in the control\n\t\t\t$control.data( '$nl_localizer_field', $field );\n\n\t\t\t// Create the storage input for the unlocalized field\n\t\t\tvar $unlocalized = $( '<input type=\"hidden\" />' );\n\t\t\t$unlocalized.attr( 'name', $field.attr( 'name' ) );\n\t\t\t$unlocalized.val( $field.val() );\n\n\t\t\t// Add to the wrapper\n\t\t\t$unlocalized.appendTo( $wrap );\n\n\t\t\t// Store the unlocalized input reference in the control\n\t\t\t$control.data( `$nl_localized_${nL.default_language}`, $unlocalized );\n\n\t\t\t// Add hidden storage inputs\n\t\t\tvar hasLocalized;\n\t\t\tLanguages.each( language => {\n\t\t\t\t// Skip the default language\n\t\t\t\tif ( nL.default_language === language.id ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Get the localized version of the value\n\t\t\t\tvar localized = values[ language.id ] || null;\n\n\t\t\t\t// Create a hidden field for the input\n\t\t\t\tvar $localized = $( '<input type=\"hidden\" />' );\n\t\t\t\t$localized.attr( 'name', `nlingual_localized[${$field.attr( 'name' )}][${language.id}]` );\n\t\t\t\t$localized.val( localized );\n\n\t\t\t\t// Store it for later use\n\t\t\t\t$control.data( `$nl_localized_${language.id}`, $localized );\n\n\t\t\t\t// Add to the wrapper\n\t\t\t\t$localized.appendTo( $wrap );\n\n\t\t\t\tif ( '' !== localized && null !== localized ) {\n\t\t\t\t\thasLocalized = true;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Add the current class to the default language if localized versions are set\n\t\t\tif ( hasLocalized ) {\n\t\t\t\t$control.find( `[data-nl_language=\"${nL.default_language}\"]` ).addClass( 'nl-current' );\n\t\t\t}\n\n\t\t\t// Add the nonce field\n\t\t\t$wrap.append( `<input type=\"hidden\" name=\"_nl_l10n_nonce[${field.id}]\" value=\"${nonce}\" />` );\n\n\t\t\t// Add the control at the end\n\t\t\t$control.appendTo( $wrap );\n\t\t} );\n\n\t\t$( 'body' ).on( 'click', '.nl-localizer-option', function() {\n\t\t\t// Get the localizer control, and the selected language\n\t\t\tvar $option  = $( this );\n\t\t\tvar $control = $option.parent();\n\t\t\tvar language = $option.data( 'nl_language' ) || nL.default_language;\n\n\t\t\t// Mark this as the new current one\n\t\t\t$( this ).addClass( 'nl-current' ).siblings().removeClass( 'nl-current' );\n\n\t\t\t// Get the current field and the localized storage field\n\t\t\tvar $field     = $control.data( '$nl_localizer_field' );\n\t\t\tvar $localized = $control.data( `$nl_localized_${language}` );\n\n\t\t\t// Before we begin changing stuff, trigger an update on the field\n\t\t\t$field.trigger( 'nl:localizer:update' );\n\n\t\t\t// Update the controls current language\n\t\t\t$control.data( 'nl_current_language', language );\n\n\t\t\t// Get the value/name of the target localized field\n\t\t\tvar value = $localized.val();\n\t\t\tvar name  = $localized.attr( 'name' );\n\n\t\t\t// Swap the field's value/name\n\t\t\t$field.val( value ).attr( 'name', name );\n\n\t\t\t// Trigger a change event, for potential extensibility\n\t\t\t$field.trigger( 'nl:localizer:change' );\n\t\t} );\n\n\t\t$( 'body' ).on( 'input nl:localizer:update nl:localizer:save', '.nl-localizable-input', function() {\n\t\t\t// Get the control reference and it's current language\n\t\t\tvar $control = $( this ).data( '$nl_localizer' );\n\t\t\tvar language = $control.data( 'nl_current_language' );\n\n\t\t\t// Get the localized storage field\n\t\t\tvar $localized = $control.data( `$nl_localized_${language}` );\n\n\t\t\t// Update it with the current value\n\t\t\t$localized.val( this.value );\n\t\t} );\n\n\t\t// =========================\n\t\t// ! - TinyMCE Extensions\n\t\t// =========================\n\n\t\tif ( typeof tinymce === 'object' ) {\n\t\t\ttinymce.on( 'SetupEditor', e => {\n\t\t\t\t// TinyMCE 4.7 changes callback arg to event CONTAINING editor\n\t\t\t\tvar editor = e.editor || e;\n\n\t\t\t\tvar $field = $( editor.getElement() ),\n\t\t\t\t\t$control = $field.data( '$nl_localizer' );\n\n\t\t\t\tif ( ! $control ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\teditor.on( 'init', () => {\n\t\t\t\t\t$( editor.getContainer() ).parent().after( $control );\n\t\t\t\t} );\n\n\t\t\t\t$field.on( 'nl:localizer:update', () => {\n\t\t\t\t\t// Get the content, clean it\n\t\t\t\t\tvar content = wp.editor.removep( editor.getContent() );\n\n\t\t\t\t\t$field.val( content );\n\t\t\t\t} );\n\n\t\t\t\t$field.on( 'nl:localizer:change', () => {\n\t\t\t\t\t// Get the value, process it\n\t\t\t\t\tvar content = wp.editor.autop( $field.val() );\n\n\t\t\t\t\teditor.setContent( content );\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\tvar oldEditorSave = tinymce.Editor.prototype.save;\n\t\t\ttinymce.Editor.prototype.save = function() {\n\t\t\t\toldEditorSave.apply( this, arguments );\n\n\t\t\t\tthis.fire( 'SavedContent' );\n\t\t\t\t$( this.getElement() ).trigger( 'nl:localizer:save' );\n\t\t\t};\n\t\t}\n\n\t\t// =========================\n\t\t// ! Meta Box and Quick/Bulk Edit\n\t\t// =========================\n\n\t\t// Update visible translation fields based on current language\n\t\t$( '.nl-language-input' ).change( function() {\n\t\t\tvar id = $( this ).val();\n\t\t\tvar $parent = $( this ).parents( '.nl-translation-manager' );\n\n\t\t\t// Toggle visibility of the translations interface if language isn't set\n\t\t\t$parent.find( '.nl-manage-translations' ).toggleClass( 'hidden', id === '0' );\n\n\t\t\t// Show all translation fields by default\n\t\t\t$parent.find( '.nl-translation-field' ).show();\n\n\t\t\t// Hide the one for the current language\n\t\t\t$parent.find( '.nl-translation-' + id ).hide();\n\t\t} ).change(); // Update on page load\n\n\t\t// Create a new translation for the assocaited language\n\t\t$( '.nl-add-translation' ).click( function() {\n\t\t\tvar $field                  = $( this ).parents( '.nl-field' );\n\t\t\tvar $input                  = $field.find( '.nl-input' );\n\t\t\tvar $select                   = $field.find( '.nl-translation-select' );\n\t\t\tvar post_id                 = $( '#post_ID' ).val();\n\t\t\tvar post_language_id        = $( '#nl_language' ).val();\n\t\t\tvar translation_language_id = $input.parents( '.nl-field' ).data( 'nl_language' );\n\n\t\t\tvar editWindow = window.open( nlingualL10n.admin_post + '?' + $.param( {\n\t\t\t\taction: 'nl_new_translation',\n\t\t\t\tpost_id,\n\t\t\t\tpost_language_id,\n\t\t\t\ttranslation_language_id,\n\t\t\t} ), '_blank' );\n\n\t\t\teditWindow.onload = function() {\n\t\t\t\tvar [ , id ] = this.location.href.match( /post=(\\d+)/ );\n\n\t\t\t\t$input.val( id );\n\t\t\t\t$field.addClass( 'nl-has-translation' );\n\t\t\t\t$select.attr( 'name', null );\n\t\t\t};\n\t\t} );\n\n\t\t// Open a search field to find an existing translation\n\t\t$( '.nl-find-translation' ).click( function() {\n\t\t\tvar $field  = $( this ).parents( '.nl-field' );\n\t\t\tvar $input  = $field.find( '.nl-translation-input' );\n\t\t\tvar $select = $field.find( '.nl-translation-select' );\n\n\t\t\t$select.attr( 'name', $input.attr( 'name' ) );\n\t\t\t$select.show();\n\t\t} );\n\n\t\t// Open the editor for the selected translation\n\t\t$( '.nl-edit-translation' ).click( function() {\n\t\t\t// Get the parent field\n\t\t\tvar $field = $( this ).parents( '.nl-field' );\n\n\t\t\t// Get the selected value\n\t\t\tvar target = $field.find( '.nl-input' ).val();\n\n\t\t\t// Throw error if target isn't a valid post\n\t\t\tif ( target === 'new' || parseInt( target, 10 ) <= 0 ) {\n\t\t\t\talert( nlingualL10n.NoPostSelected );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Build the edit URL and open in a new tab\n\t\t\tvar url = $( this ).data( 'url' ).replace( '%d', target );\n\t\t\twindow.open( url );\n\t\t} );\n\n\t\t// Unlink the target from the current post as a translation\n\t\t$( '.nl-drop-translation' ).click( function() {\n\t\t\tif ( ! confirm( nlingualL10n.RemoveTranslationConfirm ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar $field      = $( this ).parents( '.nl-field' );\n\t\t\tvar $input      = $field.find( '.nl-translation-input' );\n\t\t\tvar $title      = $field.find( '.nl-translation-title' );\n\t\t\tvar post_id     = $( '#post_ID' ).val();\n\t\t\tvar language_id = $input.parents( '.nl-field' ).data( 'nl_language' );\n\n\t\t\t$.ajax( {\n\t\t\t\turl  : ajaxurl,\n\t\t\t\ttype : 'POST',\n\t\t\t\tdata : {\n\t\t\t\t\taction: 'nl_drop_translation',\n\t\t\t\t\tpost_id,\n\t\t\t\t\tlanguage_id,\n\t\t\t\t},\n\t\t\t\tsuccess() {\n\t\t\t\t\t$input.val( null );\n\t\t\t\t\t$title.text( nlingualL10n.NoTranslation );\n\t\t\t\t\t$field.removeClass( 'nl-has-translation' );\n\t\t\t\t},\n\t\t\t\terror() {\n\t\t\t\t\talert( nlingualL10n.RemoveTranslationError );\n\t\t\t\t},\n\t\t\t} );\n\t\t} );\n\n\t\t// =========================\n\t\t// ! WP API Extensions\n\t\t// =========================\n\n\t\t// Extend inlineEditPost if available\n\t\tif ( typeof inlineEditPost === 'object' ) {\n\t\t\tconst wpInlineEditPost_edit = inlineEditPost.edit;\n\n\t\t\t// Replace with new function\n\t\t\tinlineEditPost.edit = function( post ) {\n\t\t\t\t// Start by calling the original for default behaviour\n\t\t\t\twpInlineEditPost_edit.apply( this, arguments );\n\n\t\t\t\t// Get the post ID\n\t\t\t\tvar post_id = post && parseInt( this.getId( post ), 10 ) || 0;\n\n\t\t\t\t// Get the post and edit rows\n\t\t\t\tvar $postRow = $( `#post-${post_id}` );\n\t\t\t\tvar $editRow = $( `#edit-${post_id}` );\n\n\t\t\t\t// Update the nonce field\n\t\t\t\tvar nonce = $postRow.find( '.nl-nonce' ).val();\n\t\t\t\t$editRow.find( '.nl-nonce' ).val( nonce );\n\n\t\t\t\t// Update the language field\n\t\t\t\tvar post_language = $postRow.find( '.nl-language' ).val();\n\t\t\t\t$editRow.find( '.nl-language-input' ).val( post_language ).change();\n\n\t\t\t\t// Update the translations fields\n\t\t\t\t$editRow.find( '.nl-translation-field' ).each( function() {\n\t\t\t\t\tvar id = $( this ).data( 'nl_language' );\n\t\t\t\t\tvar translation = $postRow.find( `.nl-translation-${id}` ).val();\n\n\t\t\t\t\t$( this ).find( 'select' ).val( translation || 0 );\n\t\t\t\t} );\n\t\t\t};\n\t\t}\n\n\t\t// Extend inlineEditTax if available\n\t\tif ( typeof inlineEditTax === 'object' ) {\n\t\t\tconst wpInlineEditTax_edit = inlineEditTax.edit;\n\n\t\t\t// Replace with new function\n\t\t\tinlineEditTax.edit = function( /* id */ ) {\n\n\t\t\t\t// Start by calling the original for default behaviour\n\t\t\t\twpInlineEditTax_edit.apply( this, arguments );\n\t\t\t};\n\t\t}\n\t} );\n} )();\n"]}